@using DataAccess.Models
@model List<BasketItem>
@{
    ViewData["Title"] = "Basket";
}

<!-- bascket --><!-- bascket --><!-- bascket --><!-- bascket -->

<div class="cart-container">
    <h1 class="cart-header">سبد خرید شما</h1>

    @if (!Model.Any() )
    {
        <!-- در صورت خالی بودن سبد خرید -->
        <div class="empty-cart">
            <p>سبد خرید شما خالی است</p>
            <a class="continue-shopping">ادامه خرید</a>
        </div>
    }
    else
    {
        <!-- در صورت وجود محصول در سبد خرید -->
        <table class="cart-table">
            <thead>
                <tr>
                    <th>محصول</th>
                    <th>قیمت</th>
                    <th>تعداد</th>
                    <th>جمع</th>
                    <th>حذف</th>
                </tr>
            </thead>
            <tbody>
                <!-- global totalPrice= 0; -->
                @foreach (var item in Model)
                {
                    <tr id="Basket_@item.BasketItemId">
                        <td>
                            <div style="display: flex; align-items: center;">
                                <img src="/api/FileUpload/GetFile?filename=@item.Product.ImageUrl" alt="@item.Product.ProductName" class="cart-item-image">
                                <span style="margin-right: 15px;">@item.Product.ProductName</span>
                            </div>
                        </td>
                        <td>
                            @item.Product.Price.ToString("N0") تومان
                        </td>
                        <td>
                            <div class="quantity-control">
                                <button class="quantity-btn">-</button>
                                <input id="countBasketInput" type="number" class="quantity-input" value="@item.Qty" min="1">
                                <button class="quantity-btn">+</button>
                            </div>
                        </td>
                        <td>
                            <div class="price">
                                <input id="basePrice" type="hidden" value="@item.Product.Price">
                                <strong id="basePriceShow">@item.Price.ToString("N0")  تومان</strong>
                            </div>
                        </td>
                        <td>
                            <button onclick="RemoveBasketItem(@item.BasketItemId)" class="remove-btn">حذف</button>
                        </td>
                    </tr>
                    //totalPrice = item.Price + totalPrice;
                }


                <!-- می‌توانید ردیف‌های بیشتری برای محصولات دیگر اضافه کنید -->
            </tbody>
        </table>

        <!--این قسمت رو درست کن بعدا -->

        <form asp-action="Pay" asp-controller="Order" method="post">


            <div class="cart-summary">

                <div class="summary-row">
                    <textarea style="width:stretch; direction:rtl; height:100px" class="text-opacity-100" name="address" placeholder="آدرس..."></textarea>
                </div>

                <div class="summary-row">
                    <input style="width:stretch; height:50px" type="text" name="mobile" value="" placeholder="09........." />
                </div>

                <div class="summary-row">
                    <span>مبلغ نهایی:</span>
                    <span>@(Model.Select(a => a.Price).Sum().ToString("N0"))  <strong>تومان</strong></span>
                </div>

                <button type="submit" class="checkout-btn">پرداخت و تکمیل سفارش</button>
            </div>
        </form>

    }

    <!-- در صورت وجود محصول در سبد خرید -->

</div>


